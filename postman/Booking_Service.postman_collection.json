{
  "info": {
    "name": "Booking Service API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Passenger Register",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": { "raw": "{{baseUrl}}/api/v1/auth/passenger/register", "host": ["{{baseUrl}}"], "path": ["api","v1","auth","passenger","register"] },
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"John Doe\",\n  \"phone\": \"+15550001\",\n  \"email\": \"john@example.com\",\n  \"password\": \"pass123\",\n  \"emergencyContacts\": [{\n    \"name\": \"Jane\", \"phone\": \"+15550009\"\n  }]\n}" }
          },
          "response": []
        },
        {
          "name": "Passenger Login",
          "event": [
            { "listen": "test", "script": { "exec": [
              "let json = pm.response.json();",
              "if (json.token) pm.environment.set('passengerToken', json.token);",
              "if (json.passenger && json.passenger._id) pm.environment.set('passengerId', json.passenger._id);"
            ], "type": "text/javascript" } }
          ],
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{baseUrl}}/api/v1/auth/passenger/login", "host": ["{{baseUrl}}"], "path": ["api","v1","auth","passenger","login"] },
            "body": { "mode": "raw", "raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"pass123\"\n}" }
          },
          "response": []
        },
        
        {
          "name": "Admin Register",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{baseUrl}}/api/v1/auth/admin/register", "host": ["{{baseUrl}}"], "path": ["api","v1","auth","admin","register"] },
            "body": { "mode": "raw", "raw": "{\n  \"fullName\": \"Admin\",\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}" }
          },
          "response": []
        },
        {
          "name": "Admin Login",
          "event": [
            { "listen": "test", "script": { "exec": [
              "let json = pm.response.json();",
              "if (json.token) pm.environment.set('adminToken', json.token);",
              "if (json.admin && json.admin._id) pm.environment.set('adminId', json.admin._id);"
            ], "type": "text/javascript" } }
          ],
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{baseUrl}}/api/v1/auth/admin/login", "host": ["{{baseUrl}}"], "path": ["api","v1","auth","admin","login"] },
            "body": { "mode": "raw", "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}" }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Drivers",
      "item": [
        {"name": "List Drivers (admin/staff)", "request": { "method": "GET", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"} ], "url": { "raw": "{{baseUrl}}/api/v1/drivers", "host": ["{{baseUrl}}"], "path": ["api","v1","drivers"] } }},
        {"name": "Available Nearby (passenger)", "request": { "method": "GET", "header": [ {"key":"Authorization","value":"Bearer {{passengerToken}}"} ], "url": { "raw": "{{baseUrl}}/api/v1/drivers/available?latitude=8.98&longitude=38.79&radiusKm=5&vehicleType=mini", "host": ["{{baseUrl}}"], "path": ["api","v1","drivers","available"], "query": [{"key":"latitude","value":"8.98"},{"key":"longitude","value":"38.79"},{"key":"radiusKm","value":"5"},{"key":"vehicleType","value":"mini"}] } }},
        {"name": "Driver Set Availability", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{driverToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/drivers/{{driverId}}/availability", "host": ["{{baseUrl}}"], "path": ["api","v1","drivers","{{driverId}}","availability"] }, "body": {"mode":"raw","raw":"{\n  \"available\": true\n}"} }},
        {"name": "Driver Update Location", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{driverToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/drivers/{{driverId}}/location", "host": ["{{baseUrl}}"], "path": ["api","v1","drivers","{{driverId}}","location"] }, "body": {"mode":"raw","raw":"{\n  \"latitude\": 8.98,\n  \"longitude\": 38.79\n}"} }}
      ]
    },
    {
      "name": "Passengers",
      "item": [
        { "name": "Create Passenger", "request": { "method": "POST", "header": [ { "key": "Authorization", "value": "Bearer {{adminToken}}" }, { "key": "Content-Type", "value": "application/json" } ], "url": { "raw": "{{baseUrl}}/api/v1/passengers", "host": ["{{baseUrl}}"], "path": ["api","v1","passengers"] }, "body": {"mode":"raw","raw":"{\n  \"name\": \"Jane Doe\",\n  \"phone\": \"+15551222\",\n  \"email\": \"jane@example.com\",\n  \"password\": \"pass123\"\n}" } } },
        { "name": "List Passengers", "request": { "method": "GET", "header": [ { "key": "Authorization", "value": "Bearer {{adminToken}}" } ], "url": { "raw": "{{baseUrl}}/api/v1/passengers", "host": ["{{baseUrl}}"], "path": ["api","v1","passengers"] } } }
      ]
    },
    {
      "name": "Bookings",
      "item": [
        {"name": "Admin Estimate Fare", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/bookings/estimate", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings","estimate"] }, "body": {"mode":"raw","raw":"{\n  \"vehicleType\": \"mini\",\n  \"pickup\": { \"latitude\": 8.98, \"longitude\": 38.79 },\n  \"dropoff\": { \"latitude\": 8.99, \"longitude\": 38.80 },\n  \"durationMinutes\": 20,\n  \"waitingMinutes\": 3\n}"} }},
        {
          "name": "Create Booking",
          "event": [
            { "listen": "test", "script": { "exec": [
              "let json = pm.response.json();",
              "if (json._id) pm.environment.set('bookingId', json._id);"
            ], "type": "text/javascript" } }
          ],
          "request": {
            "method": "POST",
            "header": [ {"key":"Authorization","value":"Bearer {{passengerToken}}"},{"key":"Content-Type","value":"application/json"} ],
            "url": { "raw": "{{baseUrl}}/api/v1/bookings", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings"] },
            "body": {"mode":"raw","raw":"{\n  \"passengerId\": \"{{passengerId}}\",\n  \"vehicleType\": \"mini\",\n  \"pickup\": { \"latitude\": 8.98, \"longitude\": 38.79 },\n  \"dropoff\": { \"latitude\": 8.99, \"longitude\": 38.80 },\n  \"durationMinutes\": 20,\n  \"waitingMinutes\": 3\n}"}
          }
        },
        {
          "name": "List Bookings",
          "request": { "method": "GET", "url": { "raw": "{{baseUrl}}/api/v1/bookings", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings"] } }
        },
        {"name": "Booking Lifecycle → accepted (admin)", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}/lifecycle", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings","{{bookingId}}","lifecycle"] }, "body": {"mode":"raw","raw":"{\n  \"status\": \"accepted\",\n  \"driverId\": \"{{driverId}}\"\n}"} }},
        {
          "name": "Assign Booking (Dispatcher)",
          "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"},{"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}/assign", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings","{{bookingId}}","assign"] }, "body": {"mode":"raw","raw":"{\n  \"driverId\": \"{{driverId}}\",\n  \"dispatcherId\": \"{{adminId}}\"\n}"} }
        },
        {"name": "Booking Lifecycle → ongoing (admin)", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}/lifecycle", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings","{{bookingId}}","lifecycle"] }, "body": {"mode":"raw","raw":"{\n  \"status\": \"ongoing\"\n}"} }},
        {"name": "Booking Lifecycle → completed (admin)", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"}, {"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/bookings/{{bookingId}}/lifecycle", "host": ["{{baseUrl}}"], "path": ["api","v1","bookings","{{bookingId}}","lifecycle"] }, "body": {"mode":"raw","raw":"{\n  \"status\": \"completed\"\n}"} }}
      ]
    },
    {
      "name": "Assignments",
      "item": [
        { "name": "List Assignments", "request": { "method": "GET", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"} ], "url": { "raw": "{{baseUrl}}/api/v1/assignments", "host": ["{{baseUrl}}"], "path": ["api","v1","assignments"] } } }
      ]
    },
    {
      "name": "Trips",
      "item": [
        { "name": "List Trips", "request": { "method": "GET", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"} ], "url": { "raw": "{{baseUrl}}/api/v1/trips", "host": ["{{baseUrl}}"], "path": ["api","v1","trips"] } } }
      ]
    },
    {
      "name": "Live",
      "item": [
        { "name": "Driver Push Position", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{driverToken}}"},{"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/live/push", "host": ["{{baseUrl}}"], "path": ["api","v1","live","push"] }, "body": {"mode":"raw","raw":"{\n  \"driverId\": \"{{driverId}}\",\n  \"latitude\": 8.98,\n  \"longitude\": 38.79,\n  \"status\": \"ongoing\"\n}"} } },
        { "name": "Passenger Push Position", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{passengerToken}}"},{"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/live/push", "host": ["{{baseUrl}}"], "path": ["api","v1","live","push"] }, "body": {"mode":"raw","raw":"{\n  \"passengerId\": \"{{passengerId}}\",\n  \"latitude\": 8.985,\n  \"longitude\": 38.795,\n  \"status\": \"requested\"\n}"} } }
      ]
    },
    {
      "name": "Pricing",
      "item": [
        { "name": "Create Pricing", "request": { "method": "POST", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"},{"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/pricing", "host": ["{{baseUrl}}"], "path": ["api","v1","pricing"] }, "body": {"mode":"raw","raw":"{\n  \"vehicleType\": \"mini\",\n  \"baseFare\": 2,\n  \"perKm\": 1,\n  \"perMinute\": 0.2,\n  \"waitingPerMinute\": 0.1,\n  \"surgeMultiplier\": 1\n}"} } },
        { "name": "List Pricing", "request": { "method": "GET", "url": { "raw": "{{baseUrl}}/api/v1/pricing", "host": ["{{baseUrl}}"], "path": ["api","v1","pricing"] } } },
        { "name": "Update Pricing (broadcast)", "request": { "method": "PUT", "header": [ {"key":"Authorization","value":"Bearer {{adminToken}}"},{"key":"Content-Type","value":"application/json"} ], "url": { "raw": "{{baseUrl}}/api/v1/pricing/{{pricingId}}", "host": ["{{baseUrl}}"], "path": ["api","v1","pricing","{{pricingId}}"] }, "body": {"mode":"raw","raw":"{\n  \"surgeMultiplier\": 1.5\n}"} } }
      ]
    }
  ]
}

